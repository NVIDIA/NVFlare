(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{87648:function(t,a,n){"use strict";n.r(a);var i=n(59499),e=n(57539),o=n.n(e),r=n(3159),c=n.n(r),u=n(57061),s=n(67294),l=n(27484),_=n.n(l),d=n(84506),p=n(68253),g=n(89924),f=n(11163),m=n(85893),v=o();a.default=function(){var t=d,a=(0,p.Gg)(),n=(0,f.useRouter)().push,e=(0,s.useState)([]),o=e[0],r=e[1],l=(0,s.useState)({column:"",id:-1}),h=l[0],G=l[1],y=(0,s.useState)(""),A=y[0],C=y[1];(0,s.useEffect)((function(){if(t.demo){var a={data:{status:"ok",client_list:[{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:8},capacity_id:13,created_at:"Thu, 11 Aug 2022 20:32:02 GMT",description:"",id:1,name:"",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 06:53:43 GMT"},{approval_state:0,capacity:{num_of_gpus:1,mem_per_gpu_in_GiB:16},capacity_id:10,created_at:"Thu, 11 Aug 2022 20:32:40 GMT",description:"",id:2,name:"one",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 06:53:37 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:30:51 GMT",description:"",id:4,name:"",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 05:30:51 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:39:58 GMT",description:"",id:5,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:39:58 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:40:01 GMT",description:"",id:6,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:40:01 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:41:21 GMT",description:"",id:7,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:41:21 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:44:08 GMT",description:"",id:8,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:44:08 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:32},capacity_id:19,created_at:"Fri, 12 Aug 2022 05:48:45 GMT",description:"",id:9,name:"b",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 06:54:45 GMT"}]}};if("ok"==a.data.status){var i=a.data.client_list;r(i)}else alert(a.data.status)}else g.y.getClients().then((function(t){var a=t.client_list;r(a)})).catch((function(){n("/")}))}),[a.user.token,t.demo]);var b=(0,s.useCallback)((function(t){t&&t.focus()}),[]),M=[{accessor:"name",Cell:function(t){var a=t.value,n=t.row;return(0,m.jsx)(m.Fragment,{children:"name"==h.column&&h.id==parseInt(n.id)?(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("input",{ref:b,id:n.id,value:A,title:"name",onBlur:function(t){!function(t){g.y.patchClient(parseInt(t.target.id),(0,i.Z)({},t.target.title,A)).then((function(a){if("ok"==a.status){var n=o.map((function(n){return n.id==parseInt(t.target.id)&&(n=a.client),n}));r(n)}})).catch((function(t){alert(t)}))}(t),function(t){G({column:t.target.title,id:-1})}(t)},onChange:function(t){C(t.target.value)}})}):(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{className:"inlineedit",onClick:function(){n.values.approval_state<=0&&(C(a),G({column:"name",id:parseInt(n.id)}))},children:a||"[empty client name]"})})})}},{accessor:"capacity",Cell:function(t){var a=t.value;return"NUM GPUS: "+a.num_of_gpus+";  MEM/GPU: "+a.mem_per_gpu_in_GiB}},{accessor:"organization",Cell:function(t){var a=t.value;t.row;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:a||"[none]"})})}},{accessor:"created_at",Cell:function(t){var a=t.value;return _()(a).format("MM/DD/YYYY HH:mm:ss")}},{accessor:"approval_state",Cell:function(t){var a=t.value;return a<0?"Denied":0==a?"Pending":a>=100?"Approved":a}},{accessor:"download_count",Header:"Download Count",Cell:function(t){var a=t.value;t.row;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:a||0})})}}];return(0,m.jsx)(u.Z,{title:"Project Admin: Client Sites Dashboard",children:(0,m.jsx)(c(),{title:"Clients",children:(0,m.jsx)(v,{columns:M,data:o,disableFilters:!0,getRowId:function(t,a){return""+t.id},bulkActions:[{label:"Approve Client",onClick:function(t){t.rows.map((function(t){return t.id})).forEach((function(t){g.y.patchClient(+t,{approval_state:100}).then((function(a){if("ok"==a.status){var n=o.map((function(a){return""+a.id==t&&(a.approval_state=100),a}));r(n)}})).catch((function(t){console.log(t),n("/")}))}))}},{label:"Deny Client",critical:!0,onClick:function(t){var a=t.rows.map((function(t){return t.id}));console.log("denying client(s): "+a),console.log(a),a.forEach((function(t){g.y.patchClient(+t,{approval_state:-1}).then((function(a){if("ok"==a.status){var n=o.map((function(a){return""+a.id==t&&(a.approval_state=-1),a}));r(n)}})).catch((function(t){console.log(t),n("/")}))}))}},{critical:!0,label:"Delete Client",icon:{name:"ActionsTrash",color:"red",variant:"solid"},onClick:function(t){t.rows.map((function(t){return t.id})).forEach((function(t){g.y.deleteClient(+t).then((function(t){console.log(t),console.log(t.status),"ok"==t.status||alert(t.status)}))}))}}]})})})}},70824:function(t,a,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/site-dashboard",function(){return n(87648)}])}},function(t){t.O(0,[443,539,874,774,888,179],(function(){return a=70824,t(t.s=a);var a}));var a=t.O();_N_E=a}]);