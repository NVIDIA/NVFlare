(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{8386:function(e,n,t){"use strict";t.r(n);var a=t(59499),i=t(57539),o=t.n(i),r=t(3159),c=t.n(r),s=t(57061),u=t(67294),l=t(27484),d=t.n(l),p=t(84506),f=t(68253),m=t(11163),_=t(89924),g=t(85893),h=o();n.default=function(){var e=p,n=(0,m.useRouter)().push,t=(0,f.Gg)(),i=(0,u.useState)({column:"",id:-1}),o=i[0],r=i[1],l=(0,u.useState)(""),v=l[0],b=l[1],O=(0,u.useState)([]),k=O[0],G=O[1];(0,u.useEffect)((function(){if(e.demo){var t={data:{status:"ok",user_list:[{approval_state:100,created_at:"Fri, 22 Jul 2022 16:48:27 GMT",description:"",email:"sitemanager@organization1.com",id:5,name:"John",organization:"NVIDIA",organization_id:1,password_hash:"pbkdf2:sha256:260000$93Zo4zK8kvAb6kkA$99038d7da338cdb1bc6227338f178f66cc6d2af3c471460c5b9e6c62d62c4e07",role:"org_admin",role_id:1,updated_at:"Fri, 22 Jul 2022 16:48:27 GMT"},{approval_state:-1,created_at:"Fri, 22 Jul 2022 18:30:43 GMT",description:"",email:"sitemanager@organization2.com",id:6,name:"John2",organization:"NVIDIA",organization_id:1,password_hash:"pbkdf2:sha256:260000$l7UKbuipKoFKPWyA$81912288309ce92ee89ab9a3fd427d2bd93031091a5c743373da6ed0313c9d39",role:"org_admin",role_id:1,sites:[{name:"site-1",id:0,org:"NVIDIA",num_of_gpus:4,mem_per_gpu_in_GiB:80},{name:"site-2",id:1,org:"NVIDIA",num_of_gpus:2,mem_per_gpu_in_GiB:16}],updated_at:"Fri, 22 Jul 2022 18:30:43 GMT"},{approval_state:0,created_at:"Fri, 22 Jul 2022 18:31:41 GMT",description:"",email:"sitemanager2@organization2.com",id:7,name:"John3",organization:"OTHERORG",organization_id:1,password_hash:"pbkdf2:sha256:260000$igsGpSEdV7rdRIZJ$cdc6cad4d003a0aa2adfaacd4cdb95aa9828fbc2c0d369cadb0b4926efd78029",role:"org_admin",role_id:1,sites:[{name:"OTHERORG-1",id:0,org:"OTHERORG",num_of_gpus:4,mem_per_gpu_in_GiB:16},{name:"OTHERORG-2",id:1,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32},{name:"OTHERORG-3",id:2,org:"OTHERORG",num_of_gpus:4,mem_per_gpu_in_GiB:16},{name:"OTHERORG-4",id:3,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32},{name:"OTHERORG-5",id:4,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32}],updated_at:"Fri, 22 Jul 2022 18:31:41 GMT"}]}};if("ok"==t.data.status){var a=t.data.user_list;G(a)}else alert(t.data.status)}else _.y.getUsers().then((function(e){if("undefined"!=typeof e)if("ok"==e.status){var n=e.user_list;G(n)}else alert(e.status)})).catch((function(e){console.log(e),n("/")}))}),[n,t.user.token,e.demo,e.url_root]);var R=function(e){var n=k.map((function(n){return n.id===parseInt(e.target.id)?(n[e.target.title]=v,n):n}));G(n),null!=v&&""!=v&&_.y.patchUser(parseInt(e.target.id),(0,a.Z)({},e.target.title,v)).then((function(n){!function(e,n){if("ok"==n.status){var t=k.map((function(t){return t.id==e&&(t=n.user),t}));G(t)}}(parseInt(e.target.id),n)})).catch((function(e){alert(e)})),b("")},j=function(e){r({column:e.target.title,id:-1})},w=(0,u.useCallback)((function(e){e&&e.focus()}),[]),E=[{accessor:"name"},{accessor:"email"},{accessor:"organization",Cell:function(e){var n=e.value,t=e.row;return(0,g.jsx)(g.Fragment,{children:"organization"==o.column&&o.id==parseInt(t.id)?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("input",{ref:w,id:t.id,value:v,title:"organization",onBlur:function(e){R(e),j(e)},onChange:function(e){b(e.target.value)}})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"inlineedit",onClick:function(){b(n),r({column:"organization",id:parseInt(t.id)})},children:n||"[none]"})})})}},{accessor:"role",Cell:function(e){var n=e.value,t=e.row;return(0,g.jsx)(g.Fragment,{children:"role"==o.column&&o.id==parseInt(t.id)?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("select",{ref:w,id:t.id,value:n,title:"role",onBlur:function(e){j(e)},onChange:function(e){var n=e.target.value;!function(e,n,t,i){var o=k.map((function(e){return e.id===n?(e[t]=i,null!=i&&""!=i&&_.y.patchUser(e.id,(0,a.Z)({},t,i)).then((function(e){})),e):e}));G(o)}(0,+e.target.id,e.target.title,n),j(e)},placeholder:"Please select a role...",children:[(0,g.jsx)("option",{value:"",disabled:!0,children:"Please select a role..."}),(0,g.jsx)("option",{value:"member",children:"Member"}),(0,g.jsx)("option",{value:"lead",children:"Lead"}),(0,g.jsx)("option",{value:"org_admin",children:"Org Admin"})]})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"inlineedit",onClick:function(e){"project_admin"!=n&&(b(n),r({column:"role",id:parseInt(t.id)}))},children:n?"project_admin"==n?"Project Admin":"org_admin"==n?"Org Admin":"member"==n?"Member":"lead"==n?"Lead":n:"[none]"})})})}},{accessor:"created_at",Cell:function(e){var n=e.value;return d()(n).format("MM/DD/YYYY HH:mm:ss")}},{accessor:"approval_state",Cell:function(e){var n=e.value,t=e.row;return n<0?"Denied":0==n?"Pending":n>=100?"Approved (D/L: "+t.original.download_count+")":n}}];return(0,g.jsx)(s.Z,{title:"Project Admin: Users Dashboard",children:(0,g.jsxs)(c(),{title:"Users",children:[(0,g.jsx)(h,{columns:E,data:k,rowOnClick:function(e){},rowOnSelect:function(){},rowActionsMenuOnOpen:function(){console.log("row action menu open")},disableFilters:!0,disableExport:!0,getHeaderProps:function(e){return{style:{fontSize:"1rem",fontWeight:"bold"}}},getRowId:function(e,n){return""+e.id},bulkActions:[{label:"Approve User",onClick:function(e){e.rows.map((function(e){return e.id})).forEach((function(e){_.y.patchUser(+e,{approval_state:100}).then((function(n){if("ok"==n.status){var t=k.map((function(n){return""+n.id==e&&(n.approval_state=100),n}));G(t)}})).catch((function(e){console.log(e),n("/")}))}))}},{label:"Deny User",critical:!0,onClick:function(e){var t=e.rows.map((function(e){return e.id}));console.log("denying user(s): "+t),console.log(t),t.forEach((function(e){_.y.patchUser(+e,{approval_state:-1}).then((function(n){if("ok"==n.status){var t=k.map((function(n){return""+n.id==e&&(n.approval_state=-1),n}));G(t)}})).catch((function(e){console.log(e),n("/")}))}))}},{critical:!0,label:"Delete User",icon:{name:"ActionsTrash",color:"red",variant:"solid"},onClick:function(e){e.rows.map((function(e){return e.id})).forEach((function(e){_.y.deleteUser(+e).then((function(n){"ok"==n.status?function(e){G((function(n){return n.filter((function(n){return n.id!=+e}))}))}(+e):alert(n.status)})).catch((function(){n("/")}))}))}}]}),(0,g.jsx)("p",{children:"Note: D/L in the Approval column above for approved users is the Flare Console download count."})]})})}},51746:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-admin-dashboard",function(){return t(8386)}])}},function(e){e.O(0,[234,539,874,774,888,179],(function(){return n=51746,e(e.s=n);var n}));var n=e.O();_N_E=n}]);