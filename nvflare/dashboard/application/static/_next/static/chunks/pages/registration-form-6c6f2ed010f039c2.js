(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[592],{88916:function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Styles=void 0;const s=o(n(67294)),u=o(n(31096)),l=n(7347),c=a(n(24777)),d=a(n(5801)),m=a(n(14167));t.Styles=m.default;const f=u.default.div`
  ${m.default.passwordContainer}
`;f.displayName="PasswordContainer";const p=(0,u.default)(c.default)``;p.displayName="Password";const g=(0,u.default)(d.default)`
  ${m.default.toggleVisibilityIcon}
`;g.displayName="VisibilityButton",t.default=function({autoFocus:e,className:t,disabled:n,form:r,id:i,inputMode:o,label:a,maxLength:c,minLength:d,name:m,onBlur:h,onCopy:_,onCut:v,onChange:y,onFocus:b,onKeyDown:x,onKeyPress:j,onKeyUp:w,onPaste:S,pattern:C,placeholder:N,readOnly:I,required:P,showVisibilityToggle:k=!0,tabIndex:E,title:O,validationMessage:z,value:F}){const A=(0,s.useContext)(l.KaizenThemeContext),[B,M]=(0,s.useState)(!1);return s.default.createElement(u.ThemeProvider,{theme:A},s.default.createElement(f,{className:t,"data-testid":"kui-password"},s.default.createElement(p,{autoCapitalize:"off",autoComplete:"on",autoFocus:e,disabled:n,form:r,id:i,inputMode:o,inputType:B?"singleLine":"password",label:a,maxLength:c,minLength:d,name:m,onBlur:h,onCopy:_,onCut:v,onChange:y,onFocus:b,onKeyDown:x,onKeyPress:j,onKeyUp:w,onPaste:S,pattern:C,placeholder:N,readOnly:I,required:P,showValidIcon:!1,spellCheck:!1,tabIndex:E,title:O,value:F,validationMessage:z}),k&&s.default.createElement(g,{onClick:()=>{M(!B)},icon:{name:B?"ActionsHide":"ActionsView"},variant:"link"})))}},14167:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={passwordContainer:"\n  position: relative;\n  width: 100%;\n",toggleVisibilityIcon:"\n  position: absolute;\n  right: 1rem;\n  top: 2.5rem;\n"}},89924:function(e,t,n){"use strict";n.d(t,{y:function(){return _}});var r=n(9669),i=n.n(r),o=n(84506),a=n(68253),s=n(35823),u=n.n(s),l=o,c=i().create({baseURL:l.url_root+"/api/v1/",headers:{"Access-Control-Allow-Origin":"*"}});c.interceptors.request.use((function(e){return e.headers.Authorization="Bearer "+(0,a.Gg)().user.token,e}),(function(e){console.log("Interceptor request error: "+e)})),c.interceptors.response.use((function(e){return e}),(function(e){throw console.log(" AXIOS error: "),console.log(e),401===e.response.status&&(0,a.KY)("","",-1,0,"",!0),403===e.response.status&&console.log("Error: "+e.response.data.status),409===e.response.status&&console.log("Error: "+e.response.data.status),422===e.response.status&&(0,a.KY)("","",-1,0,"",!0),e}));var d=function(e){return e.data},m=function(e){return c.get(e).then(d)},f=function(e,t,n){return c.post(e,{pin:n},{responseType:"blob"}).then((function(e){t=e.headers["content-disposition"].split('"')[1],u()(e.data,t)}))},p=function(e,t){return c.post(e,t).then(d)},g=function(e,t){return c.patch(e,t).then(d)},h=function(e){return c.delete(e).then(d)},_={login:function(e){return p("login",e)},getUsers:function(){return m("users")},getUser:function(e){return m("users/".concat(e))},getUserStartupKit:function(e,t,n){return f("users/".concat(e,"/blob"),t,n)},getClientStartupKit:function(e,t,n){return f("clients/".concat(e,"/blob"),t,n)},getOverseerStartupKit:function(e,t){return f("overseer/blob",e,t)},getServerStartupKit:function(e,t,n){return f("servers/".concat(e,"/blob"),t,n)},getClients:function(){return m("clients")},getProject:function(){return m("project")},postUser:function(e){return p("users",e)},patchUser:function(e,t){return g("users/".concat(e),t)},deleteUser:function(e){return h("users/".concat(e))},postClient:function(e){return p("clients",e)},patchClient:function(e,t){return g("clients/".concat(e),t)},deleteClient:function(e){return h("clients/".concat(e))},patchProject:function(e){return g("project",e)},getServer:function(){return m("server")},patchServer:function(e){return g("server",e)}}},88001:function(e,t,n){"use strict";n.d(t,{Z:function(){return y}});var r=n(41664),i=n.n(r),o=n(29224),a=n.n(o),s=n(70491),u=n.n(s),l=n(86188),c=n.n(l),d=n(31096),m=d.default.div.withConfig({displayName:"styles__StyledLayout",componentId:"sc-y3h7zi-0"})(["overflow:hidden;height:100%;width:100%;margin:0;padding:0;display:flex;flex-wrap:wrap;.menu{height:auto;}.content-header{flex:0 0 80px;}"]),f=d.default.div.withConfig({displayName:"styles__StyledContent",componentId:"sc-y3h7zi-1"})(["display:flex;flex-direction:column;flex:1 1 0%;overflow:auto;height:calc(100% - 3rem);.inlineeditlarger{padding:10px;}.inlineedit{padding:10px;margin:-10px;}.content-wrapper{padding:",";min-height:800px;}"],(function(e){return e.theme.spacing.four})),p=n(11163),g=(n(84506),n(67294)),h=n(68253),_=n(89924),v=n(85893),y=function(e){var t=e.children,n=e.headerChildren,r=e.title,o=(0,p.useRouter)(),s=o.pathname,l=(o.push,(0,g.useState)()),d=l[0],y=l[1];(0,h.Gg)();return(0,g.useEffect)((function(){_.y.getProject().then((function(e){y(e.project)}))}),[]),(0,v.jsxs)(m,{children:[(0,v.jsx)(a(),{app:null===d||void 0===d?void 0:d.short_name}),(0,v.jsx)(c(),{className:"menu",itemMatchPattern:function(e){return e===s},itemRenderer:function(e){var t=e.title,n=e.href;return(0,v.jsx)(i(),{href:n,children:t})},location:s}),(0,v.jsxs)(f,{children:[(0,v.jsx)(u(),{className:"content-header",title:r,children:n}),(0,v.jsx)("div",{className:"content-wrapper",children:t})]})]})}},56921:function(e,t,n){"use strict";n.d(t,{P:function(){return l},X:function(){return u}});var r=n(31096),i=n(36578),o=n.n(i),a=n(3159),s=n.n(a),u=(0,r.default)(s()).withConfig({displayName:"form-page__StyledFormExample",componentId:"sc-rfrcq8-0"})([".bottom{display:flex;gap:",";}.zero-left{margin-left:0;}.zero-right{margin-right:0;}"],(function(e){return e.theme.spacing.four})),l=(0,r.default)(o()).withConfig({displayName:"form-page__StyledBanner",componentId:"sc-rfrcq8-1"})(["margin-bottom:1rem;"])},44119:function(e,t,n){"use strict";n.r(t);var r=n(59499),i=n(76687),o=n(82175),a=n(74231),s=n(5801),u=n.n(s),l=n(90878),c=n.n(l),d=n(24777),m=n.n(d),f=n(88916),p=n.n(f),g=n(56921),h=n(67294),_=n(3159),v=n.n(_),y=n(32754),b=n.n(y),x=n(11163),j=n(57539),w=n.n(j),S=(n(84506),n(68253)),C=n(89924),N=n(88001),I=n(85893),P=a.Ry().shape({email:a.Z_().email("Invalid email").required("Required"),name:a.Z_().min(1,"Too Short!").max(50,"Too Long!").required("Required"),password:a.Z_().required("Required"),confirm_password:a.Z_().oneOf([a.iH("password"),null],"Passwords do not match!").required("Required")}),k=a.Ry().shape({role:a.Z_().required("Required"),org:a.Z_().min(2,"Too Short!").required("Required")});t.default=function(){var e=(0,x.useRouter)().push,t=(0,S.Gg)(),n=(0,h.useState)([]),a=n[0],s=n[1],l=(0,h.useState)(1),d=l[0],f=l[1],_=(0,h.useState)(-1),y=_[0],j=_[1],E=(0,h.useState)(""),O=E[0],z=E[1],F=(0,h.useState)({column:"",id:-1}),A=F[0],B=F[1],M=(0,h.useState)(""),G=M[0],q=M[1],R=(0,h.useState)(!1),T=R[0],K=R[1],U=(0,h.useState)(!1),L=U[0],V=U[1];(0,h.useEffect)((function(){-1==t.user.role&&(f(2),j(t.user.id))}),[t.user.id,t.user.role]);var Z=function(){s([].concat((0,i.Z)(a),[{name:"",id:-1,org:O,num_of_gpus:4,mem_per_gpu_in_GiB:16,approval_state:0}])),B({column:"name",id:-1}),q(""),K(!0)},J=function(e){!function(e,t,n,r){var i=a.map((function(e){return e.id===t?(e[n]=r,e):e}));s(i)}(0,parseInt(e.target.id),e.target.title,G),T?(Y(G),K(!1)):D(parseInt(e.target.id),e.target.title,G),q("")},Y=function(e){var t={name:e,organization:O,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16}};C.y.postClient(t).then((function(e){if("ok"==e.status){var t=a.map((function(t){return-1==t.id&&(console.log(t),t.id=e.client.id),t}));s(t)}})).catch((function(e){alert("Your session may have timed out. Please log in from the home page to add or edit client sites.")}))},X=function(e,t){if("ok"==t.status){var n=a.map((function(n){var r,i;n.id==e&&(n={name:t.client.name,id:t.client.id,org:t.client.organization,num_of_gpus:null===(r=t.client.capacity)||void 0===r?void 0:r.num_of_gpus,mem_per_gpu_in_GiB:null===(i=t.client.capacity)||void 0===i?void 0:i.mem_per_gpu_in_GiB,approval_state:t.client.approval_state});return n}));s(n)}},D=function(e,t,n){if("name"===t)C.y.patchClient(e,(0,r.Z)({},t,n)).then((function(t){X(e,t)})).catch((function(e){alert("Error saving site information, you may need to log in again.")}));else if("num_of_gpus"===t){var i,o=null===(i=a.find((function(t){return t.id===e})))||void 0===i?void 0:i.mem_per_gpu_in_GiB;C.y.patchClient(e,{capacity:{num_of_gpus:parseInt(n),mem_per_gpu_in_GiB:o||16}}).then((function(t){X(e,t)})).catch((function(e){alert("Error saving site information, you may need to log in again.")}))}else if("mem_per_gpu_in_GiB"===t){var s,u=null===(s=a.find((function(t){return t.id===e})))||void 0===s?void 0:s.num_of_gpus;C.y.patchClient(e,{capacity:{num_of_gpus:u||0,mem_per_gpu_in_GiB:parseInt(n)}}).then((function(t){X(e,t)})).catch((function(e){alert("Error saving site information, you may need to log in again.")}))}},H=function(e){B({column:e.target.title,id:-1})},$=(0,h.useCallback)((function(e){e&&e.focus()}),[]),Q=[{accessor:"name",Cell:function(e){var t=e.value,n=e.row;return(0,I.jsx)(I.Fragment,{children:"name"==A.column&&A.id==parseInt(n.id)?(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("input",{ref:$,id:n.id,value:G,title:"name",onBlur:function(e){J(e),H(e)},placeholder:"site name",onChange:function(e){q(e.target.value)}})}):(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{className:"inlineedit",onClick:function(){q(t),B({column:"name",id:parseInt(n.id)})},children:t||"[none]"})})})}},{accessor:"num_of_gpus",Header:"NUM GPUS",Cell:function(e){var t=e.value,n=e.row;return(0,I.jsx)(I.Fragment,{children:"num_of_gpus"==A.column&&A.id==parseInt(n.id)?(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("input",{ref:$,id:n.id,value:G,title:"num_of_gpus",onBlur:function(e){J(e),H(e)},onChange:function(e){q(e.target.value)}})}):(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{className:"inlineedit",onClick:function(){q(t),B({column:"num_of_gpus",id:parseInt(n.id)})},children:t})})})}},{accessor:"mem_per_gpu_in_GiB",Header:"Memory per gpu (GiB)",Cell:function(e){var t=e.value,n=e.row;return(0,I.jsx)(I.Fragment,{children:"mem_per_gpu_in_GiB"==A.column&&A.id==parseInt(n.id)?(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("input",{ref:$,id:n.id,value:G,title:"mem_per_gpu_in_GiB",onBlur:function(e){J(e),H(e)},onChange:function(e){q(e.target.value)}})}):(0,I.jsx)(I.Fragment,{children:(0,I.jsx)("div",{className:"inlineedit",onClick:function(){q(t),B({column:"mem_per_gpu_in_GiB",id:parseInt(n.id)})},children:t})})})}},{id:"delete",Cell:function(e){var t=e.v,n=e.row;return(0,I.jsx)("div",{children:(0,I.jsx)(u(),{icon:{name:"ActionsTrash",variant:"solid"},onClick:function(){console.log("DELETING CLIENT: "+n.id),C.y.deleteClient(parseInt(n.id)).then((function(e){console.log(e),console.log(e.status),"ok"==e.status?s(a.filter((function(e){return e.id!=parseInt(n.id)}))):alert(e.status)}))},onMouseOut:function(){},onMouseOver:function(){},shape:"rectangle",size:"regular",tag:"button",type:"critical",variant:"outline",width:"fit-content",children:t})})}}];var W=[{label:"Member",value:"member"},{label:"Lead",value:"lead"},{label:"Org Admin",value:"org_admin"}];return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(N.Z,{title:"User Registration",children:[1==d&&(0,I.jsx)(o.J9,{initialValues:{email:"",name:"",password:"",confirm_password:""},onSubmit:function(e,t){C.y.postUser(e).then((function(t){C.y.login({email:e.email,password:e.password}).then((function(e){"undefined"!==typeof e&&"ok"==e.status&&(0,S.KY)(e.user.email,e.access_token,e.user.id,1)})),j(t.user.id),f(2)})).catch((function(e){t.setSubmitting(!1),409==e.response.status?alert("Error: The email you are trying to register may already be in the system. Please try registering with another email or contact the Project Administrator for assistance."):alert("Error: The project may not be configured properly for user registration. Please contact the Project Administrator for assistance.")}))},validationSchema:P,children:function(e){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.P,{rounded:!0,children:"After creating your user account, you can choose your role and configure client sites if applicable."}),(0,I.jsxs)(g.X,{loading:e.isSubmitting,title:"Register",children:[(0,I.jsx)(c(),{tag:"label",textStyle:"p1",children:"Create a user to log in and manage your account for the FL project."}),(0,I.jsx)(o.gN,{as:m(),className:"zero-left zero-right",disabled:e.isSubmitting,inputMode:"email",label:"Email",name:"email",pattern:e.errors.email,placeholder:"email@domain.com",validationMessage:e.errors.email}),(0,I.jsx)("div",{className:"name",children:(0,I.jsx)(o.gN,{as:m(),className:"zero-left",disabled:e.isSubmitting,label:"Name",name:"name",pattern:e.errors.name,placeholder:"Name",validationMessage:e.errors.name})}),(0,I.jsxs)("div",{className:"bottom",children:[(0,I.jsx)(o.gN,{as:p(),className:"zero-left zero-right",disabled:e.isSubmitting,label:"Password",name:"password",pattern:e.errors.password,placeholder:"Enter your password",validationMessage:e.errors.password}),(0,I.jsx)(o.gN,{as:p(),className:"zero-left zero-right",disabled:e.isSubmitting,label:"Confirm password",name:"confirm_password",pattern:e.errors.confirm_password,placeholder:"Confirm your password",validationMessage:e.errors.confirm_password})]}),(0,I.jsx)(u(),{disabled:!e.dirty||!e.isValid,onClick:function(){return e.handleSubmit()},children:"Register"})]})]})}}),2==d&&(0,I.jsx)(o.J9,{initialValues:{role:"member",org:""},onSubmit:function(e,t){console.log("Submitting values: ".concat(JSON.stringify(e,null,2))),z(e.org),C.y.patchUser(y,{organization:e.org,role:e.role}).then((function(e){"member"==e.user.role&&((0,S.a5)(1),f(3)),"lead"!=e.user.role&&"member"!=e.user.role||((0,S.a5)(2),f(3)),"org_admin"==e.user.role&&((0,S.a5)(3),V(!0),t.setSubmitting(!1))})).catch((function(e){alert("Error with user update. Your session may have timed out. Please contact your site administrator if you need to set organization or role.")}))},validationSchema:k,children:function(e){return(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(g.X,{loading:e.isSubmitting,title:"Configure organization and role",children:[(0,I.jsx)(c(),{tag:"label",textStyle:"p1",children:"Enter your organization and select your role:"}),(0,I.jsxs)("div",{className:"organdsite",children:[(0,I.jsx)(o.gN,{as:m(),className:"zero-left zero-right",disabled:e.isSubmitting||L,label:"Organization",name:"org",pattern:e.errors.org,placeholder:"Enter your organization",validationMessage:e.errors.org}),(0,I.jsx)(o.gN,{as:b(),className:"zero-left zero-right",disabled:e.isSubmitting||L,label:"Role",name:"role",value:(t=e.values.role,W.find((function(e){return e.value==t}))),onChange:function(t){console.log(e),null===t?e.setFieldValue("role",null):e.setFieldValue("role",t.value)},placeholder:"Please select a role...",options:W})]}),(0,I.jsx)("br",{}),!L&&(0,I.jsx)(u(),{disabled:!e.dirty||!e.isValid,onClick:function(){return e.handleSubmit()},children:"Save"}),"org_admin"==e.values.role&&L&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsxs)("div",{style:{width:"42rem"},children:[(0,I.jsx)("br",{}),(0,I.jsx)(v(),{actions:(0,I.jsx)(u(),{type:"primary",variant:"outline",onClick:Z,children:"Add Site"}),title:"As Org Admin, you can add and configure client sites:",children:(0,I.jsx)(w(),{columns:Q,data:a,disableFilters:!0,getRowId:function(e,t){return""+e.id}})})]}),(0,I.jsx)("br",{}),(0,I.jsx)(u(),{disabled:!e.dirty||!e.isValid,onClick:function(){return f(3)},children:"Next"})]})]})});var t}}),3==d&&(0,I.jsx)(I.Fragment,{children:(0,I.jsxs)(v(),{children:[(0,I.jsx)("h2",{children:"Thank you for completing your registration. You will be able to download startup kits once the Project Admin approves your registration."}),(0,I.jsx)("br",{}),(0,I.jsx)(u(),{onClick:function(){return e("/user-dashboard")},children:"Go to my dashboard"})]})})]})})}},68253:function(e,t,n){"use strict";n.d(t,{Gg:function(){return a},KY:function(){return i},a5:function(){return o}});var r={user:{email:"",token:"",id:-1,role:0},status:"unauthenticated"};function i(e,t,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return r={user:{email:e,token:t,id:n,role:i,org:o},expired:a,status:0==i?"unauthenticated":"authenticated"},localStorage.setItem("session",JSON.stringify(r)),r}function o(e){return r={user:{email:r.user.email,token:r.user.token,id:r.user.id,role:e,org:r.user.org},expired:r.expired,status:r.status},localStorage.setItem("session",JSON.stringify(r)),r}function a(){var e=localStorage.getItem("session");return null!=e&&(r=JSON.parse(e)),r}},51323:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/registration-form",function(){return n(44119)}])},76687:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.d(t,{Z:function(){return i}})},84506:function(e){"use strict";e.exports=JSON.parse('{"projectname":"New FL Project","demo":false,"url_root":"http://127.0.0.1:443","arraydata":[{"name":"itemone"},{"name":"itemtwo"},{"name":"itemthree"}]}')}},function(e){e.O(0,[443,539,27,774,888,179],(function(){return t=51323,e(e.s=t);var t}));var t=e.O();_N_E=t}]);