(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{23772:function(t,n,a){"use strict";a.r(n);var i=a(8307),e=a(57539),o=a.n(e),r=a(3159),c=a.n(r),u=a(12976),s=a(67294),l=a(27484),d=a.n(l),_=a(84506),p=a(40203),g=a(14682),f=a(11163),m=a(85893),v=o();n.default=function(){var t=(0,p.Gg)(),n=(0,f.useRouter)().push,a=(0,s.useState)([]),e=a[0],o=a[1],r=(0,s.useState)({column:"",id:-1}),l=r[0],h=r[1],G=(0,s.useState)(""),y=G[0],b=G[1];(0,s.useEffect)(function(){if(_.demo){var t={data:{status:"ok",client_list:[{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:8},capacity_id:13,created_at:"Thu, 11 Aug 2022 20:32:02 GMT",description:"",id:1,name:"",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 06:53:43 GMT"},{approval_state:0,capacity:{num_of_gpus:1,mem_per_gpu_in_GiB:16},capacity_id:10,created_at:"Thu, 11 Aug 2022 20:32:40 GMT",description:"",id:2,name:"one",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 06:53:37 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:30:51 GMT",description:"",id:4,name:"",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 05:30:51 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:39:58 GMT",description:"",id:5,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:39:58 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:40:01 GMT",description:"",id:6,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:40:01 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:41:21 GMT",description:"",id:7,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:41:21 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16},capacity_id:2,created_at:"Fri, 12 Aug 2022 05:44:08 GMT",description:"",id:8,name:"",organization:"bbb",organization_id:19,updated_at:"Fri, 12 Aug 2022 05:44:08 GMT"},{approval_state:0,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:32},capacity_id:19,created_at:"Fri, 12 Aug 2022 05:48:45 GMT",description:"",id:9,name:"b",organization:"NVIDIA",organization_id:1,updated_at:"Fri, 12 Aug 2022 06:54:45 GMT"}]}};"ok"==t.data.status?o(t.data.client_list):alert(t.data.status)}else g.y.getClients().then(function(t){o(t.client_list)}).catch(function(){n("/")})},[t.user.token,_.demo]);var A=function(t){g.y.patchClient(parseInt(t.target.id),(0,i.Z)({},t.target.title,y)).then(function(n){"ok"==n.status&&o(e.map(function(a){return a.id==parseInt(t.target.id)&&(a=n.client),a}))}).catch(function(t){alert(t)})},C=function(t){h({column:t.target.title,id:-1})},F=(0,s.useCallback)(function(t){t&&t.focus()},[]),M=function(t){o(function(n){return n.filter(function(n){return n.id!=+t})})},T=[{accessor:"name",Cell:function(t){var n=t.value,a=t.row;return(0,m.jsx)(m.Fragment,{children:"name"==l.column&&l.id==parseInt(a.id.toString())?(0,m.jsx)("input",{ref:F,id:a.id.toString(),value:y,title:"name",onBlur:function(t){A(t),C(t)},onChange:function(t){b(t.target.value)}}):(0,m.jsx)("div",{className:"inlineedit",onClick:function(){a.values.approval_state<=0&&(b(n),h({column:"name",id:parseInt(a.id.toString())}))},children:n||"[empty client name]"})})}},{accessor:"capacity",Cell:function(t){var n=t.value;return(0,m.jsx)(m.Fragment,{children:"NUM GPUS: ".concat(null==n?void 0:n.num_of_gpus,"; MEM/GPU: ").concat(null==n?void 0:n.mem_per_gpu_in_GiB)})}},{accessor:"organization",Cell:function(t){var n=t.value;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:n||"[none]"})})}},{accessor:"created_at",Cell:function(t){var n=t.value;return(0,m.jsx)(m.Fragment,{children:d()(n).format("MM/DD/YYYY HH:mm:ss")})}},{accessor:"approval_state",Cell:function(t){var n=t.value;return(0,m.jsx)(m.Fragment,{children:n<0?"Denied":0==n?"Pending":n>=100?"Approved":n})}},{accessor:"download_count",Header:"Download Count",Cell:function(t){var n=t.value;return(0,m.jsx)(m.Fragment,{children:(0,m.jsx)("div",{children:n||0})})}}];return(0,m.jsx)(u.Z,{title:"Project Admin: Client Sites Dashboard",children:(0,m.jsx)(c(),{title:"Clients",children:(0,m.jsx)(v,{columns:T,data:e,disableFilters:!0,disableExport:!0,getHeaderProps:function(t){return{style:{fontSize:"1rem",fontWeight:"bold"}}},getRowId:function(t,n){return""+t.id},bulkActions:[{label:"Approve Client",onClick:function(t){t.rows.map(function(t){return t.id}).forEach(function(t){g.y.patchClient(+t,{approval_state:100}).then(function(n){"ok"==n.status&&o(e.map(function(n){return""+n.id==t&&(n.approval_state=100),n}))}).catch(function(t){console.log(t),n("/")})})}},{label:"Deny Client",critical:!0,onClick:function(t){var a=t.rows.map(function(t){return t.id});console.log("denying client(s): "+a),console.log(a),a.forEach(function(t){g.y.patchClient(+t,{approval_state:-1}).then(function(n){"ok"==n.status&&o(e.map(function(n){return""+n.id==t&&(n.approval_state=-1),n}))}).catch(function(t){console.log(t),n("/")})})}},{critical:!0,label:"Delete Client",icon:{name:"ActionsTrash",color:"red",variant:"solid"},onClick:function(t){t.rows.map(function(t){return t.id}).forEach(function(t){g.y.deleteClient(+t).then(function(n){"ok"==n.status?M(+t):alert(n.status)}).catch(function(){n("/")})})}}]})})})}},70824:function(t,n,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/site-dashboard",function(){return a(23772)}])}},function(t){t.O(0,[234,539,983,888,774,179],function(){return t(t.s=70824)}),_N_E=t.O()}]);