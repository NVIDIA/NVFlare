(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[592],{48484:function(e,n,t){"use strict";t.r(n);var i=t(8307),r=t(76687),o=t(73214),a=t(74231),s=t(5801),l=t.n(s),u=t(90878),c=t.n(u),d=t(89002),m=t(67294),p=t(3159),f=t.n(p),g=t(11163),h=t(57539),_=t.n(h),v=t(78455);t(84506);var y=t(40203),b=t(14682),j=t(13936),x=t(85893),S=a.Ry().shape({email:a.Z_().email("Invalid email").required("Required"),name:a.Z_().min(1,"Too Short!").max(50,"Too Long!").required("Required"),password:a.Z_().required("Required"),confirm_password:a.Z_().oneOf([a.iH("password"),null],"Passwords do not match!").required("Required")}),w=a.Ry().shape({role:a.Ry({label:a.Z_(),value:a.Z_()}).required("Required"),org:a.Z_().min(2,"Too Short!").required("Required")});n.default=function(){var e=(0,g.useRouter)().push,n=(0,y.Gg)(),t=(0,m.useState)([]),a=t[0],s=t[1],u=(0,m.useState)(1),p=u[0],h=u[1],C=(0,m.useState)(-1),I=C[0],k=C[1],E=(0,m.useState)(""),G=E[0],N=E[1],A=(0,m.useState)({column:"",id:-1}),B=A[0],P=A[1],R=(0,m.useState)(""),T=R[0],q=R[1],Z=(0,m.useState)(!1),z=Z[0],F=Z[1],O=(0,m.useState)(!1),M=O[0],U=O[1],L=_();(0,m.useEffect)(function(){-1==n.user.role&&(h(2),k(n.user.id))},[n.user.id,n.user.role]);var V=function(){s([].concat((0,r.Z)(a),[{name:"",id:-1,org:G,num_of_gpus:4,mem_per_gpu_in_GiB:16,approval_state:0}])),P({column:"name",id:-1}),q(""),F(!0)},H=function(e,n,t,i){s(a.map(function(e){return e.id===n&&(e[t]=i),e}))},X=function(e){""!=T&&(H(e,parseInt(e.target.id),e.target.title,T),z?Y(T,e.target.title):-1!=parseInt(e.target.id)&&K(parseInt(e.target.id),e.target.title,T),q(""))},Y=function(e,n){b.y.postClient({name:e,organization:G,capacity:{num_of_gpus:4,mem_per_gpu_in_GiB:16}}).then(function(e){"ok"==e.status&&s(a.map(function(n){return -1==n.id&&(console.log(n),n.id=e.client.id),n})),F(!1),W(n)}).catch(function(e){J(e)})},J=function(e){console.log(e),409==e.response.status?alert("This site name already exists. Please choose another site name."):alert("Your session may have timed out. Please log in from the home page to add or edit client sites.")},D=function(e,n){"ok"==n.status&&s(a.map(function(t){if(t.id==e){var i,r;t={name:n.client.name,id:n.client.id,org:n.client.organization,num_of_gpus:null===(i=n.client.capacity)||void 0===i?void 0:i.num_of_gpus,mem_per_gpu_in_GiB:null===(r=n.client.capacity)||void 0===r?void 0:r.mem_per_gpu_in_GiB,approval_state:n.client.approval_state}}return t}))},K=function(e,n,t){if("name"===n)b.y.patchClient(e,(0,i.Z)({},n,t)).then(function(t){D(e,t),W(n)}).catch(function(e){J(e)});else if("num_of_gpus"===n){var r,o=null===(r=a.find(function(n){return n.id===e}))||void 0===r?void 0:r.mem_per_gpu_in_GiB;b.y.patchClient(e,{capacity:{num_of_gpus:parseInt(t)>-1?parseInt(t):4,mem_per_gpu_in_GiB:o||0}}).then(function(t){D(e,t),W(n)}).catch(function(e){J(e)})}else if("mem_per_gpu_in_GiB"===n){var s,l=null===(s=a.find(function(n){return n.id===e}))||void 0===s?void 0:s.num_of_gpus;b.y.patchClient(e,{capacity:{num_of_gpus:l||0,mem_per_gpu_in_GiB:parseInt(t)>-1?parseInt(t):16}}).then(function(t){D(e,t),W(n)}).catch(function(e){J(e)})}},W=function(e){P({column:e,id:-1})},$=(0,m.useCallback)(function(e){e&&e.focus()},[]),Q=[{accessor:"name",Cell:function(e){var n=e.value,t=e.row;return(0,x.jsx)(x.Fragment,{children:"name"==B.column&&B.id==parseInt(t.id.toString())?(0,x.jsx)("input",{ref:$,id:t.id.toString(),value:T,title:"name",onBlur:function(e){X(e)},placeholder:"site name",onChange:function(e){q(e.target.value)}}):(0,x.jsx)("div",{className:"inlineedit",onClick:function(){q(n),P({column:"name",id:parseInt(t.id.toString())})},children:n||"[none]"})})}},{accessor:"num_of_gpus",Header:"NUM GPUS",Cell:function(e){var n=e.value,t=e.row;return(0,x.jsx)(x.Fragment,{children:"num_of_gpus"==B.column&&B.id==parseInt(t.id.toString())?(0,x.jsx)("input",{ref:$,id:t.id.toString(),value:T,title:"num_of_gpus",onBlur:function(e){X(e)},onChange:function(e){q(e.target.value)}}):(0,x.jsx)("div",{className:"inlineedit",onClick:function(){q(n),P({column:"num_of_gpus",id:parseInt(t.id.toString())})},children:n})})}},{accessor:"mem_per_gpu_in_GiB",Header:"Memory per gpu (GiB)",Cell:function(e){var n=e.value,t=e.row;return(0,x.jsx)(x.Fragment,{children:"mem_per_gpu_in_GiB"==B.column&&B.id==parseInt(t.id.toString())?(0,x.jsx)("input",{ref:$,id:t.id.toString(),value:T,title:"mem_per_gpu_in_GiB",onBlur:function(e){X(e)},onChange:function(e){q(e.target.value)}}):(0,x.jsx)("div",{className:"inlineedit",onClick:function(){q(n),P({column:"mem_per_gpu_in_GiB",id:parseInt(t.id.toString())})},children:n})})}},{id:"delete",Cell:function(e){var n=e.value,t=e.row;return(0,x.jsx)("div",{children:(0,x.jsx)(l(),{icon:{name:"ActionsTrash",variant:"solid"},onClick:function(){console.log("DELETING CLIENT: "+t.id),b.y.deleteClient(parseInt(t.id.toString())).then(function(e){console.log(e),console.log(e.status),"ok"==e.status?s(a.filter(function(e){return e.id!=parseInt(t.id.toString())})):alert(e.status)})},onMouseOut:function(){},onMouseOver:function(){},shape:"rectangle",size:"regular",tag:"button",type:"critical",variant:"outline",width:"fit-content",children:n})})}}];return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(j.Z,{title:"User Registration",children:[1==p&&(0,x.jsx)(o.J9,{initialValues:{email:"",name:"",password:"",confirm_password:""},onSubmit:function(e,n){b.y.postUser(e).then(function(n){b.y.login({email:e.email,password:e.password}).then(function(e){void 0!==e&&"ok"==e.status&&(0,y.KY)(e.user.email,e.access_token,e.user.id,1)}),k(n.user.id),h(2)}).catch(function(e){n.setSubmitting(!1),409==e.response.status?alert("Error: The email you are trying to register may already be in the system. Please try registering with another email or contact the Project Administrator for assistance."):alert("Error: The project may not be configured properly for user registration. Please contact the Project Administrator for assistance.")})},validationSchema:S,children:function(e){return(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.P,{rounded:!0,children:"After creating your user account, you can choose your role and configure client sites if applicable."}),(0,x.jsxs)(d.X,{loading:e.isSubmitting,title:"Register",children:[(0,x.jsx)(c(),{tag:"label",textStyle:"p1",children:"Create a user to log in and manage your account for the FL project."}),(0,x.jsx)(v.nv,{inputMode:"email",label:"Email",name:"email",placeholder:"email@domain.com"}),(0,x.jsx)("div",{className:"name",children:(0,x.jsx)(v.nv,{label:"Name",name:"name",placeholder:"Name"})}),(0,x.jsxs)("div",{className:"bottom",children:[(0,x.jsx)(v.nv,{inputType:"password",label:"Password",name:"password",placeholder:"Enter your password"}),(0,x.jsx)(v.nv,{inputType:"password",label:"Confirm password",name:"confirm_password",placeholder:"Confirm your password"})]}),(0,x.jsx)(l(),{disabled:!e.dirty||!e.isValid,onClick:function(){return e.handleSubmit()},children:"Register"})]})]})}}),2==p&&(0,x.jsx)(o.J9,{initialValues:{role:{label:"Member",value:"member"},org:""},onSubmit:function(e,n){N(e.org),b.y.patchUser(I,{organization:e.org,role:e.role.value}).then(function(e){"member"==e.user.role&&((0,y.a5)(1),h(3)),("lead"==e.user.role||"member"==e.user.role)&&((0,y.a5)(2),h(3)),"org_admin"==e.user.role&&((0,y.a5)(3),U(!0),n.setSubmitting(!1))}).catch(function(e){alert("Error with user update. Your session may have timed out. Please contact your site administrator if you need to set organization or role.")})},validationSchema:w,children:function(e){return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(d.X,{loading:e.isSubmitting,title:"Configure organization and role",children:[(0,x.jsx)(c(),{tag:"label",textStyle:"p1",children:"Enter your organization and select your role:"}),(0,x.jsxs)("div",{className:"organdsite",children:[(0,x.jsx)(v.nv,{disabled:e.isSubmitting||M,label:"Organization",name:"org",placeholder:"Enter your organization"}),(0,x.jsx)(v.mg,{disabled:M,label:"Role",name:"role",placeholder:"Please select a role...",options:[{label:"Member",value:"member"},{label:"Lead",value:"lead"},{label:"Org Admin",value:"org_admin"}]})]}),(0,x.jsx)("br",{}),!M&&(0,x.jsx)(l(),{disabled:!e.dirty||!e.isValid,onClick:function(){return e.handleSubmit()},children:"Save"}),"org_admin"==e.values.role.value&&M&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)("div",{style:{width:"42rem"},children:[(0,x.jsx)("br",{}),(0,x.jsx)(f(),{actions:(0,x.jsx)(l(),{type:"primary",variant:"outline",onClick:V,children:"Add Site"}),title:"As Org Admin, you can add and configure client sites:",children:(0,x.jsx)(L,{columns:Q,data:a,disableFilters:!0,disableExport:!0,getHeaderProps:function(e){return{style:{fontSize:"1rem",fontWeight:"bold"}}},getRowId:function(e,n){return""+e.id}})})]}),(0,x.jsx)("br",{}),(0,x.jsx)(l(),{disabled:!e.dirty||!e.isValid,onClick:function(){return h(3)},children:"Next"})]})]})})}}),3==p&&(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)(f(),{children:[(0,x.jsx)("h2",{children:"Thank you for completing your registration. You will be able to download startup kits once the Project Admin approves your registration."}),(0,x.jsx)("br",{}),(0,x.jsx)(l(),{onClick:function(){return e("/user-dashboard")},children:"Go to my dashboard"})]})})]})})}},51323:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/registration-form",function(){return t(48484)}])},76687:function(e,n,t){"use strict";function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,i=Array(n);t<n;t++)i[t]=e[t];return i}function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(e){if("string"==typeof e)return i(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);if("Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t.d(n,{Z:function(){return r}})}},function(e){e.O(0,[234,539,787,390,888,774,179],function(){return e(e.s=51323)}),_N_E=e.O()}]);