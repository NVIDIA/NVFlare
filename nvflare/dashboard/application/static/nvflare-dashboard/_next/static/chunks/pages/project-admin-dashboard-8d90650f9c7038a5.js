(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{8386:function(n,e,t){"use strict";t.r(e);var a=t(59499),i=t(57539),o=t.n(i),r=t(3159),c=t.n(r),s=t(57061),u=t(67294),l=t(27484),d=t.n(l),f=t(84506),p=t(68253),m=t(11163),_=t(89924),g=t(85893),h=o();e.default=function(){var n=f,e=(0,m.useRouter)().push,t=(0,p.Gg)(),i=(0,u.useState)({column:"",id:-1}),o=i[0],r=i[1],l=(0,u.useState)(""),v=l[0],b=l[1],O=(0,u.useState)([]),k=O[0],G=O[1];(0,u.useEffect)((function(){if(n.demo){var t={data:{status:"ok",user_list:[{approval_state:100,created_at:"Fri, 22 Jul 2022 16:48:27 GMT",description:"",email:"sitemanager@organization1.com",id:5,name:"John",organization:"NVIDIA",organization_id:1,password_hash:"pbkdf2:sha256:260000$93Zo4zK8kvAb6kkA$99038d7da338cdb1bc6227338f178f66cc6d2af3c471460c5b9e6c62d62c4e07",role:"org_admin",role_id:1,updated_at:"Fri, 22 Jul 2022 16:48:27 GMT"},{approval_state:-1,created_at:"Fri, 22 Jul 2022 18:30:43 GMT",description:"",email:"sitemanager@organization2.com",id:6,name:"John2",organization:"NVIDIA",organization_id:1,password_hash:"pbkdf2:sha256:260000$l7UKbuipKoFKPWyA$81912288309ce92ee89ab9a3fd427d2bd93031091a5c743373da6ed0313c9d39",role:"org_admin",role_id:1,sites:[{name:"site-1",id:0,org:"NVIDIA",num_of_gpus:4,mem_per_gpu_in_GiB:80},{name:"site-2",id:1,org:"NVIDIA",num_of_gpus:2,mem_per_gpu_in_GiB:16}],updated_at:"Fri, 22 Jul 2022 18:30:43 GMT"},{approval_state:0,created_at:"Fri, 22 Jul 2022 18:31:41 GMT",description:"",email:"sitemanager2@organization2.com",id:7,name:"John3",organization:"OTHERORG",organization_id:1,password_hash:"pbkdf2:sha256:260000$igsGpSEdV7rdRIZJ$cdc6cad4d003a0aa2adfaacd4cdb95aa9828fbc2c0d369cadb0b4926efd78029",role:"org_admin",role_id:1,sites:[{name:"OTHERORG-1",id:0,org:"OTHERORG",num_of_gpus:4,mem_per_gpu_in_GiB:16},{name:"OTHERORG-2",id:1,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32},{name:"OTHERORG-3",id:2,org:"OTHERORG",num_of_gpus:4,mem_per_gpu_in_GiB:16},{name:"OTHERORG-4",id:3,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32},{name:"OTHERORG-5",id:4,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32}],updated_at:"Fri, 22 Jul 2022 18:31:41 GMT"}]}};if("ok"==t.data.status){var a=t.data.user_list;G(a)}else alert(t.data.status)}else _.y.getUsers().then((function(n){if("undefined"!=typeof n)if("ok"==n.status){var e=n.user_list;G(e)}else alert(n.status)})).catch((function(n){console.log(n),e("/")}))}),[e,t.user.token,n.demo,n.url_root]);var R=function(n){var e=k.map((function(e){return e.id===parseInt(n.target.id)?(e[n.target.title]=v,e):e}));G(e),null!=v&&""!=v&&_.y.patchUser(parseInt(n.target.id),(0,a.Z)({},n.target.title,v)).then((function(e){!function(n,e){if("ok"==e.status){var t=k.map((function(t){return t.id==n&&(t=e.user),t}));G(t)}}(parseInt(n.target.id),e)})).catch((function(n){alert(n)})),b("")},j=function(n){r({column:n.target.title,id:-1})},w=(0,u.useCallback)((function(n){n&&n.focus()}),[]),E=[{accessor:"name"},{accessor:"email"},{accessor:"organization",Cell:function(n){var e=n.value,t=n.row;return(0,g.jsx)(g.Fragment,{children:"organization"==o.column&&o.id==parseInt(t.id)?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("input",{ref:w,id:t.id,value:v,title:"organization",onBlur:function(n){R(n),j(n)},onChange:function(n){b(n.target.value)}})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"inlineedit",onClick:function(){b(e),r({column:"organization",id:parseInt(t.id)})},children:e||"[none]"})})})}},{accessor:"role",Cell:function(n){var e=n.value,t=n.row;return(0,g.jsx)(g.Fragment,{children:"role"==o.column&&o.id==parseInt(t.id)?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("select",{ref:w,id:t.id,value:e,title:"role",onBlur:function(n){j(n)},onChange:function(n){var e=n.target.value;!function(n,e,t,i){var o=k.map((function(n){return n.id===e?(n[t]=i,null!=i&&""!=i&&_.y.patchUser(n.id,(0,a.Z)({},t,i)).then((function(n){})),n):n}));G(o)}(0,+n.target.id,n.target.title,e),j(n)},children:[(0,g.jsx)("option",{value:"",disabled:!0,children:"Please select a role..."}),(0,g.jsx)("option",{value:"member",children:"Member"}),(0,g.jsx)("option",{value:"lead",children:"Lead"}),(0,g.jsx)("option",{value:"org_admin",children:"Org Admin"})]})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"inlineedit",onClick:function(n){"project_admin"!=e&&(b(e),r({column:"role",id:parseInt(t.id)}))},children:e?"project_admin"==e?"Project Admin":"org_admin"==e?"Org Admin":"member"==e?"Member":"lead"==e?"Lead":e:"[none]"})})})}},{accessor:"created_at",Cell:function(n){var e=n.value;return d()(e).format("MM/DD/YYYY HH:mm:ss")}},{accessor:"approval_state",Cell:function(n){var e=n.value,t=n.row;return e<0?"Denied":0==e?"Pending":e>=100?"Approved (D/L: "+t.original.download_count+")":e}}];return(0,g.jsx)(s.Z,{title:"Project Admin: Users Dashboard",children:(0,g.jsxs)(c(),{title:"Users",children:[(0,g.jsx)(h,{columns:E,data:k,rowOnClick:function(n){},rowOnSelect:function(){},rowActionsMenuOnOpen:function(){console.log("row action menu open")},disableFilters:!0,disableExport:!0,getHeaderProps:function(n){return{style:{fontSize:"1rem",fontWeight:"bold"}}},getRowId:function(n,e){return""+n.id},bulkActions:[{label:"Approve User",onClick:function(n){n.rows.map((function(n){return n.id})).forEach((function(n){_.y.patchUser(+n,{approval_state:100}).then((function(e){if("ok"==e.status){var t=k.map((function(e){return""+e.id==n&&(e.approval_state=100),e}));G(t)}})).catch((function(n){console.log(n),e("/")}))}))}},{label:"Deny User",critical:!0,onClick:function(n){var t=n.rows.map((function(n){return n.id}));console.log("denying user(s): "+t),console.log(t),t.forEach((function(n){_.y.patchUser(+n,{approval_state:-1}).then((function(e){if("ok"==e.status){var t=k.map((function(e){return""+e.id==n&&(e.approval_state=-1),e}));G(t)}})).catch((function(n){console.log(n),e("/")}))}))}},{critical:!0,label:"Delete User",icon:{name:"ActionsTrash",color:"red",variant:"solid"},onClick:function(n){n.rows.map((function(n){return n.id})).forEach((function(n){_.y.deleteUser(+n).then((function(e){"ok"==e.status?function(n){G((function(e){return e.filter((function(e){return e.id!=+n}))}))}(+n):alert(e.status)})).catch((function(){e("/")}))}))}}]}),(0,g.jsx)("p",{children:"Note: D/L in the Approval column above for approved users is the Flare Console download count."})]})})}},51746:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-admin-dashboard",function(){return t(8386)}])}},function(n){n.O(0,[234,539,874,774,888,179],(function(){return e=51746,n(n.s=e);var e}));var e=n.O();_N_E=e}]);