(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{72135:function(n,e,t){"use strict";t.r(e);var a=t(8307),i=t(57539),o=t.n(i),r=t(3159),c=t.n(r),s=t(12976),u=t(67294),l=t(27484),d=t.n(l),p=t(84506),m=t(40203),_=t(11163),f=t(14682),g=t(85893),h=o();e.default=function(){var n=(0,_.useRouter)().push,e=(0,m.Gg)(),t=(0,u.useState)({column:"",id:-1}),i=t[0],o=t[1],r=(0,u.useState)(""),l=r[0],v=r[1],b=(0,u.useState)([]),O=b[0],k=b[1];(0,u.useEffect)(function(){if(p.demo){var e={data:{status:"ok",user_list:[{approval_state:100,created_at:"Fri, 22 Jul 2022 16:48:27 GMT",description:"",email:"sitemanager@organization1.com",id:5,name:"John",organization:"NVIDIA",organization_id:1,password_hash:"pbkdf2:sha256:260000$93Zo4zK8kvAb6kkA$99038d7da338cdb1bc6227338f178f66cc6d2af3c471460c5b9e6c62d62c4e07",role:"org_admin",role_id:1,updated_at:"Fri, 22 Jul 2022 16:48:27 GMT"},{approval_state:-1,created_at:"Fri, 22 Jul 2022 18:30:43 GMT",description:"",email:"sitemanager@organization2.com",id:6,name:"John2",organization:"NVIDIA",organization_id:1,password_hash:"pbkdf2:sha256:260000$l7UKbuipKoFKPWyA$81912288309ce92ee89ab9a3fd427d2bd93031091a5c743373da6ed0313c9d39",role:"org_admin",role_id:1,sites:[{name:"site-1",id:0,org:"NVIDIA",num_of_gpus:4,mem_per_gpu_in_GiB:80},{name:"site-2",id:1,org:"NVIDIA",num_of_gpus:2,mem_per_gpu_in_GiB:16}],updated_at:"Fri, 22 Jul 2022 18:30:43 GMT"},{approval_state:0,created_at:"Fri, 22 Jul 2022 18:31:41 GMT",description:"",email:"sitemanager2@organization2.com",id:7,name:"John3",organization:"OTHERORG",organization_id:1,password_hash:"pbkdf2:sha256:260000$igsGpSEdV7rdRIZJ$cdc6cad4d003a0aa2adfaacd4cdb95aa9828fbc2c0d369cadb0b4926efd78029",role:"org_admin",role_id:1,sites:[{name:"OTHERORG-1",id:0,org:"OTHERORG",num_of_gpus:4,mem_per_gpu_in_GiB:16},{name:"OTHERORG-2",id:1,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32},{name:"OTHERORG-3",id:2,org:"OTHERORG",num_of_gpus:4,mem_per_gpu_in_GiB:16},{name:"OTHERORG-4",id:3,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32},{name:"OTHERORG-5",id:4,org:"OTHERORG",num_of_gpus:2,mem_per_gpu_in_GiB:32}],updated_at:"Fri, 22 Jul 2022 18:31:41 GMT"}]}};"ok"==e.data.status?k(e.data.user_list):alert(e.data.status)}else f.y.getUsers().then(function(n){void 0!==n&&("ok"==n.status?k(n.user_list):alert(n.status))}).catch(function(e){console.log(e),n("/")})},[n,e.user.token,p.demo,p.url_root]);var G=function(n,e,t,i){k(O.map(function(n){return n.id===e&&(n[t]=i,null!=i&&""!=i&&f.y.patchUser(n.id,(0,a.Z)({},t,i)).then(function(n){})),n}))},R=function(n,e){"ok"==e.status&&k(O.map(function(t){return t.id==n&&(t=e.user),t}))},j=function(n){k(O.map(function(e){return e.id===parseInt(n.target.id)&&(e[n.target.title]=l),e})),null!=l&&""!=l&&f.y.patchUser(parseInt(n.target.id),(0,a.Z)({},n.target.title,l)).then(function(e){R(parseInt(n.target.id),e)}).catch(function(n){alert(n)}),v("")},w=function(n){k(function(e){return e.filter(function(e){return e.id!=+n})})},E=function(n){o({column:n.target.title,id:-1})},T=(0,u.useCallback)(function(n){n&&n.focus()},[]),x=[{accessor:"name"},{accessor:"email"},{accessor:"organization",Cell:function(n){var e=n.value,t=n.row;return(0,g.jsx)(g.Fragment,{children:"organization"==i.column&&i.id==parseInt(t.id)?(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("input",{ref:T,id:t.id,value:l,title:"organization",onBlur:function(n){j(n),E(n)},onChange:function(n){v(n.target.value)}})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"inlineedit",onClick:function(){v(e),o({column:"organization",id:parseInt(t.id)})},children:e||"[none]"})})})}},{accessor:"role",Cell:function(n){var e=n.value,t=n.row;return(0,g.jsx)(g.Fragment,{children:"role"==i.column&&i.id==parseInt(t.id)?(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("select",{ref:T,id:t.id,value:e,title:"role",onBlur:function(n){E(n)},onChange:function(n){var e=n.target.value;G(n,+n.target.id,n.target.title,e),E(n)},children:[(0,g.jsx)("option",{value:"",disabled:!0,children:"Please select a role..."}),(0,g.jsx)("option",{value:"member",children:"Member"}),(0,g.jsx)("option",{value:"lead",children:"Lead"}),(0,g.jsx)("option",{value:"org_admin",children:"Org Admin"})]})}):(0,g.jsx)(g.Fragment,{children:(0,g.jsx)("div",{className:"inlineedit",onClick:function(n){"project_admin"!=e&&(v(e),o({column:"role",id:parseInt(t.id)}))},children:e?"project_admin"==e?"Project Admin":"org_admin"==e?"Org Admin":"member"==e?"Member":"lead"==e?"Lead":e:"[none]"})})})}},{accessor:"created_at",Cell:function(n){var e=n.value;return d()(e).format("MM/DD/YYYY HH:mm:ss")}},{accessor:"approval_state",Cell:function(n){var e=n.value,t=n.row;return e<0?"Denied":0==e?"Pending":e>=100?"Approved (D/L: "+t.original.download_count+")":e}}];return(0,g.jsx)(s.Z,{title:"Project Admin: Users Dashboard",children:(0,g.jsxs)(c(),{title:"Users",children:[(0,g.jsx)(h,{columns:x,data:O,rowOnClick:function(n){},rowOnSelect:function(){},rowActionsMenuOnOpen:function(){console.log("row action menu open")},disableFilters:!0,disableExport:!0,getHeaderProps:function(n){return{style:{fontSize:"1rem",fontWeight:"bold"}}},getRowId:function(n,e){return""+n.id},bulkActions:[{label:"Approve User",onClick:function(e){e.rows.map(function(n){return n.id}).forEach(function(e){f.y.patchUser(+e,{approval_state:100}).then(function(n){"ok"==n.status&&k(O.map(function(n){return""+n.id==e&&(n.approval_state=100),n}))}).catch(function(e){console.log(e),n("/")})})}},{label:"Deny User",critical:!0,onClick:function(e){var t=e.rows.map(function(n){return n.id});console.log("denying user(s): "+t),console.log(t),t.forEach(function(e){f.y.patchUser(+e,{approval_state:-1}).then(function(n){"ok"==n.status&&k(O.map(function(n){return""+n.id==e&&(n.approval_state=-1),n}))}).catch(function(e){console.log(e),n("/")})})}},{critical:!0,label:"Delete User",icon:{name:"ActionsTrash",color:"red",variant:"solid"},onClick:function(e){e.rows.map(function(n){return n.id}).forEach(function(e){f.y.deleteUser(+e).then(function(n){"ok"==n.status?w(+e):alert(n.status)}).catch(function(){n("/")})})}}]}),(0,g.jsx)("p",{children:"Note: D/L in the Approval column above for approved users is the Flare Console download count."})]})})}},51746:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project-admin-dashboard",function(){return t(72135)}])}},function(n){n.O(0,[234,539,983,888,774,179],function(){return n(n.s=51746)}),_N_E=n.O()}]);