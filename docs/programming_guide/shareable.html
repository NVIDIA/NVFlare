<!--
# Copyright (c) 2020, NVIDIA CORPORATION. All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
#  * Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
#  * Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
#  * Neither the name of NVIDIA CORPORATION nor the names of its
#    contributors may be used to endorse or promote products derived
#    from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY
# EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
# PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR
# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
# EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
# PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
# PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
# OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
# (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
-->


<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Shareable &mdash; NVIDIA FLARE 2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/additions.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Exchange Object (DXO)" href="data_exchange_object.html" />
    <link rel="prev" title="NVIDIA FLARE Event Mechanism" href="event_system.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
           

          
            <a href="../index.html" class="icon icon-home"> NVIDIA FLARE
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

  <style>
    /* Sidebar header (and topbar for mobile) */
    .wy-side-nav-search, .wy-nav-top {
      background: #76b900;
    }

    .wy-side-nav-search a:link, .wy-nav-top a:link {
      color: #fff;
    }
    .wy-side-nav-search a:visited, .wy-nav-top a:visited {
      color: #fff;
    }
    .wy-side-nav-search a:hover, .wy-nav-top a:hover {
      color: #fff;
    }

    .wy-menu-vertical a:link, .wy-menu-vertical a:visited {
      color: #d9d9d9
    }

    .wy-menu-vertical a:active {
      background-color: #76b900
    }

    .wy-side-nav-search>div.version {
      color: rgba(0, 0, 0, 0.3)
    }

    .wy-nav-content {
      max-width: 80%;
    }

    .floatleftcol {
      float: left;
      max-width: 60%;
      padding-right: 20px;
    }
  </style>
  
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide - Provision, Start, Operate</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../programming_guide.html">Programming Guide - Developing Apps with NVIDIA FLARE</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="fl_context.html">FLContext</a></li>
<li class="toctree-l2"><a class="reference internal" href="fl_component.html">FLComponent</a></li>
<li class="toctree-l2"><a class="reference internal" href="controllers.html">Controllers and Controller API</a></li>
<li class="toctree-l2"><a class="reference internal" href="filters.html">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="executor.html">Executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="event_system.html">NVIDIA FLARE Event Mechanism</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Shareable</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#headers">Headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="#content">Content</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#peer-properties">Peer Properties</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cookie">Cookie</a></li>
<li class="toctree-l4"><a class="reference internal" href="#return-code">Return Code</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data_exchange_object.html">Data Exchange Object (DXO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="best_practices.html">NVIDIA FLARE Programming Best Practices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../apidocs/modules.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Appendix</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NVIDIA FLARE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../programming_guide.html">Programming Guide - Developing Apps with NVIDIA FLARE</a> &raquo;</li>
        
      <li>Shareable</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/programming_guide/shareable.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="shareable">
<span id="id1"></span><h1>Shareable<a class="headerlink" href="#shareable" title="Permalink to this headline">¶</a></h1>
<p>A <a class="reference internal" href="../apidocs/nvflare.apis.html#nvflare.apis.shareable.Shareable" title="nvflare.apis.shareable.Shareable"><code class="xref py py-class docutils literal notranslate"><span class="pre">Shareable</span></code></a> object represents a communication between server and client.
Technically a Shareable object is implemented as a Python dict. This dict contains two kinds of information:</p>
<div class="section" id="headers">
<h2>Headers<a class="headerlink" href="#headers" title="Permalink to this headline">¶</a></h2>
<p>A special item in the Shareable is “headers”, which is a dict itself. The headers are used to carry meta information
about the communication (e.g. peer identity name, peer’s run number, cookies, return code, etc.). Headers are usually
added and processed by the framework.</p>
</div>
<div class="section" id="content">
<h2>Content<a class="headerlink" href="#content" title="Permalink to this headline">¶</a></h2>
<p>All other items in the Shareable object are the contents of the communication. You can place any elements into the
Shareable object, but never use ReservedHeaderKey.HEADERS as the key of your content elements.</p>
<p>For all methods of Shareable, see <a class="reference internal" href="../apidocs/nvflare.apis.html#nvflare.apis.shareable.Shareable" title="nvflare.apis.shareable.Shareable"><code class="xref py py-class docutils literal notranslate"><span class="pre">nvflare.apis.shareable.Shareable</span></code></a>.</p>
<div class="section" id="peer-properties">
<h3>Peer Properties<a class="headerlink" href="#peer-properties" title="Permalink to this headline">¶</a></h3>
<p>When processing requests or responses (which are all Shareable objects), you can get the information about the peer
site using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peer_props</span> <span class="o">=</span> <span class="n">shareable</span><span class="o">.</span><span class="n">get_peer_props</span><span class="p">()</span>
</pre></div>
</div>
<p>This is a Python dictionary that contains peer site information.</p>
</div>
<div class="section" id="cookie">
<h3>Cookie<a class="headerlink" href="#cookie" title="Permalink to this headline">¶</a></h3>
<p>If you are a workflow developer, when processing the client’s Get Task Request, you sometimes want to keep some contextual info with the task assignment
sent to the client, and expect this info echoed back in the client’s task result submission. This can be done through
the cookie mechanism.</p>
<p>A cookie is just a named piece of data (key/value pair). During the task request processing, any involved component
(Controller, Filters, Event Handlers, etc.) can add a cookie to the FLContext:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shareable</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">whatEverData</span><span class="p">)</span>
</pre></div>
</div>
<p>The headers of the Shareable object can keep a special public prop called “Cookie Jar”, which is just a Python dict.</p>
<p>The NVIDIA FLARE framework guarantees that the cookie jar prop will be sent back to the server when the client submits
the task result to the server.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Cookie data is for the server’s consumption only. Client processing logic should not rely on the knowledge of cookie
data.</p>
</div>
</div>
<div class="section" id="return-code">
<h3>Return Code<a class="headerlink" href="#return-code" title="Permalink to this headline">¶</a></h3>
<p>Another special header element from the client’s task result submission (which is a Shareable object too) is “return code”. This is a
string that indicates whether the task was successfully executed. If this element is not present in the headers, it
is considered to be successful.</p>
<p>You can get the return code with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shareable</span><span class="o">.</span><span class="n">get_return_code</span><span class="p">()</span>
</pre></div>
</div>
<p>The return code specifies error condition that prevented the task from being executed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MISSING_PEER_CONTEXT</span> <span class="o">=</span> <span class="s2">&quot;MISSING_PEER_CONTEXT&quot;</span>
<span class="n">BAD_PEER_CONTEXT</span> <span class="o">=</span> <span class="s2">&quot;BAD_PEER_CONTEXT&quot;</span>
<span class="n">RUN_MISMATCH</span> <span class="o">=</span> <span class="s2">&quot;RUN_MISMATCH&quot;</span>
<span class="n">TASK_UNKNOWN</span> <span class="o">=</span> <span class="s2">&quot;TASK_UNKNOWN&quot;</span>
<span class="n">TASK_DATA_FILTER_ERROR</span> <span class="o">=</span> <span class="s2">&quot;TASK_DATA_FILTER_ERROR&quot;</span>
<span class="n">TASK_RESULT_FILTER_ERROR</span> <span class="o">=</span> <span class="s2">&quot;TASK_RESULT_FILTER_ERROR&quot;</span>
<span class="n">EXECUTION_EXCEPTION</span> <span class="o">=</span> <span class="s2">&quot;EXECUTION_EXCEPTION&quot;</span>
<span class="n">EXECUTION_RESULT_ERROR</span> <span class="o">=</span> <span class="s2">&quot;EXECUTION_RESULT_ERROR&quot;</span>
</pre></div>
</div>
<p>Some error conditions should never occur (e.g. MISSING_PEER_CONTEXT, BAD_PEER_CONTEXT).</p>
<p>RUN_MISMATCH - client and server are out of sync on the RUN. When this happens, the client will automatically end the RUN.</p>
<p>TASK_UNKNOWN - client cannot find an executor for the assigned task. This is usually caused by misconfiguration of the task table.</p>
<p>TASK_DATA_FILTER_ERROR - client failed to filter task data. Usually bugs in one of the filters.</p>
<p>TASK_RESULT_FILTER_ERROR - client failed to filter results generated by the task executor. Usually bugs in one of the filters.</p>
<p>EXECUTION_EXCEPTION - client failed the task execution. Usually bugs in the executor code.</p>
<p>EXECUTION_RESULT_ERROR - the executor failed to generate a Shareable object as the result - bugs in the code.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="data_exchange_object.html" class="btn btn-neutral float-right" title="Data Exchange Object (DXO)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="event_system.html" class="btn btn-neutral float-left" title="NVIDIA FLARE Event Mechanism" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, NVIDIA.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
  a:link, a:visited {
    color: #76b900;
  }

  a:hover {
    color: #8c0;
  }

  p {
    margin-bottom: 1em;
  }

  .rst-content dl dt {
    font-weight: unset;
    margin-bottom: 0;
  }

  .rst-content .section ul p {
    margin-bottom: 0px;
  }
  </style>
  

</body>
</html>